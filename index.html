<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼šè®®åç‰Œç”Ÿæˆå™¨</title>
    <!-- ç›´æ¥å¼•å…¥pinyin-proåº“ -->
    <script src="https://unpkg.com/pinyin-pro@3.18.6/dist/index.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        
        :root {
            --primary-color: #3498db;
            --primary-hover: #2980b9;
            --secondary-color: #2ecc71;
            --secondary-hover: #27ae60;
            --accent-color: #e74c3c;
            --text-color: #34495e;
            --light-gray: #f5f7fa;
            --border-color: #dfe4ea;
            --shadow-color: rgba(0,0,0,0.05);
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            margin: 0;
            padding: var(--spacing-lg);
            font-family: 'Noto Sans SC', system-ui, -apple-system, sans-serif;
            background-color: var(--light-gray);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 16px var(--shadow-color);
            padding: var(--spacing-lg);
            overflow-x: hidden;
        }
        
        .preview-area {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            overflow-x: hidden;
            padding: 20px;
            box-sizing: border-box;
        }
        
        .page {
            position: relative;
            width: 210mm;
            margin: 0 auto;
            padding: 0;
            background: white;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 20px var(--shadow-color);
            page-break-inside: avoid;
            break-inside: avoid;
            border-radius: 2px;
            box-sizing: border-box;
            max-width: calc(100% - 40px);
            min-height: 297mm;
        }
        
        h1 {
            text-align: center;
            margin-bottom: var(--spacing-lg);
            color: #00a884;
            font-weight: 700;
            font-size: 4rem;
            letter-spacing: -0.5px;
            text-shadow: 3px 3px 0 #fff, 5px 5px 0 rgba(0,0,0,0.3);
            position: relative;
            padding: 10px 0;
            transform: translateZ(0);
            -webkit-text-stroke: 2px rgba(255,100,100,0.5);
            /* text-stroke: 2px rgba(255,100,100,0.5); */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* æ ‡é¢˜ä¸¤ä¾§æ°´å°æ ·å¼ */
        .container {
            position: relative;
        }
        
        .container::before,
        .container::after {
            content: "Designed by 102878";
            position: absolute;
            top: 50px;
            color: rgba(150, 150, 150, 0.2);
            font-size: 1.2rem;
            transform: rotate(45deg);
            white-space: nowrap;
            pointer-events: none;
            z-index: 0;
        }
        
        .container::before {
            left: 20px;
        }
        
        .container::after {
            right: 20px;
        }
        
        .input-area {
            margin-bottom: var(--spacing-lg);
            background-color: var(--light-gray);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border: none;
        }
        
        .input-label {
            display: block;
            margin-bottom: 10px;
            font-size: 1rem;
            color: var(--text-color);
        }
        
        #namesInput {
            width: 100%;
            height: 120px;
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-md);
            font-size: 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background-color: var(--input-bg);
            resize: vertical;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        
        #namesInput:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.15);
        }
        
        .button-group {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: center;
        }
        
        /* çˆ±å¿ƒæ³¡æ³¡åŠ¨ç”»æ ·å¼ - æ‰å¹³åŒ–é£æ ¼ */
        @keyframes float {
            0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 0.9; }
            50% { transform: translateY(-80px) scale(1.1) rotate(10deg); opacity: 0.6; }
            100% { transform: translateY(-250px) scale(0.8) rotate(20deg); opacity: 0; }
        }
        
        .heart {
            position: absolute;
            font-size: 28px;
            color: var(--accent-color);
            pointer-events: none;
            z-index: 1000;
            animation: float 1.2s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
            text-shadow: none;
        }
        
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 500;
            transition: all 0.2s ease;
            color: white;
            box-shadow: none;
        }
        
        #previewButton {
            background-color: var(--primary-color);
        }
        
        #previewButton:hover {
            background-color: var(--primary-hover);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        
        .preview-area {
            width: 100%;
            margin: var(--spacing-lg) auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px var(--shadow-color);
            background-color: var(--light-gray);
            padding: 10mm 15mm 5mm 15mm;
            border-radius: var(--radius-md);
            box-sizing: border-box;
        }
        
        .page {
            width: 210mm;
            height: 297mm;
            background: var(--card-bg);
            position: relative;
            margin-bottom: 10mm;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px var(--shadow-color);
            page-break-inside: avoid;
            break-inside: avoid;
            border-radius: var(--radius-sm);
            box-sizing: border-box;
            max-width: 100%;
            /* ç¡®ä¿é¡µé¢å®¹å™¨å°ºå¯¸å›ºå®š */
            min-height: 297mm;
        }
        
        .page:not(:last-child):after {
            content: '';
            position: absolute;
            bottom: -5mm;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color) 20%, var(--border-color) 80%, transparent);
            width: 80%;
            margin: 0 auto;
        }
        .name {
            position: absolute;
            width: 100%;
            left: 0;
            text-align: center;
            font-size: 127px;
            margin: 0;
            padding: 0;
            line-height: 1.2;
            font-weight: bold;
            color: #000000;
            text-shadow: none;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        /* ä¿®æ”¹æ¨¡å¼ä¸€åå­—çš„ä½ç½®å’Œæ ·å¼ */
        .name.name-1 { 
            top: 23mm; /* ä»80pxè½¬æ¢ä¸º28mm */
            z-index: 2;
            color: #000; /* ç¡®ä¿åå­—é¢œè‰²ä¸èƒŒæ™¯å¯¹æ¯”æ˜æ˜¾ */
        }
        .name.name-2 { 
            top: 115mm; /* ä»377pxè½¬æ¢ä¸º133mm */
            z-index: 2;
            color: #000; /* ç¡®ä¿åå­—é¢œè‰²ä¸èƒŒæ™¯å¯¹æ¯”æ˜æ˜¾ */
        }
        .name.name-3 { 
            top: 215mm; /* ä»674pxè½¬æ¢ä¸º238mm */
            z-index: 2;
            color: #000; /* ç¡®ä¿åå­—é¢œè‰²ä¸èƒŒæ™¯å¯¹æ¯”æ˜æ˜¾ */
        }
        
        /* æ¨¡å¼ä¸€ï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .name.two-chars {
            letter-spacing: 1em; /* å¢åŠ å­—é—´è·åˆ°1em */
            text-align: center;
            width: 100%;
            padding-left: 0; /* ç§»é™¤å·¦å†…è¾¹è· */
            box-sizing: border-box;
            transform: none; /* ç§»é™¤å¯èƒ½å¯¼è‡´åç§»çš„transform */
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            margin-left: 0.5em; /* æ•´ä½“å¾®è°ƒ */
        }
        
        /* æ¨¡å¼ä¸€ï¼šèƒŒæ™¯å›¾ç‰‡æ ·å¼ */
        .mode1-bg-image {
            position: absolute;
            width: 210mm;  /* A4çº¸å®½åº¦ */
            height: 99mm;  /* A4çº¸é«˜åº¦çš„ä¸‰åˆ†ä¹‹ä¸€ */
            left: 0;
            z-index: 1;
            object-fit: contain; /* ç¡®ä¿å›¾ç‰‡ä¿æŒé•¿å®½æ¯” */
            object-position: center; /* å±…ä¸­æ˜¾ç¤º */
            max-width: 100%; /* ç¡®ä¿ä¸ä¼šè¶…å‡ºå®¹å™¨ */
        }
        
        /* æ¨¡å¼äºŒæ ·å¼ */
        .mode2-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(4, 1fr);
            width: 100%;
            height: 100%;
            position: relative;
            gap: 0;
        }
        
        /* æ·»åŠ æ°´å¹³åˆ†å‰²çº¿ */
        .mode2-grid::before {
            content: '';
            position: absolute;
            top: 25%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        .mode2-grid::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ·»åŠ ç¬¬ä¸‰æ¡æ°´å¹³çº¿ */
        .horizontal-line {
            position: absolute;
            top: 75%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ·»åŠ å‚ç›´åˆ†å‰²çº¿ */
        .vertical-line {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ¨¡å¼äºŒï¼šæ·»åŠ logoæ ·å¼ */
        .mode2-logo {
            position: absolute;
            top: 5mm;
            left: 5mm;
            height: 30px; /* ä»15pxæ”¹ä¸º45pxï¼Œæ”¾å¤§ä¸‰å€ */
            z-index: 2;
        }
        
        /* ç¡®ä¿mode2-cardä¿æŒç›¸å¯¹å®šä½ */
        .mode2-card {
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10mm 5mm;
            box-sizing: border-box;
            height: 100%;
            width: 100%;
        }
        
        .mode2-name {
            font-size: 96px;
            font-weight: bold;
            text-align: center;
            margin: 10mm 0 10px 0; /* æ·»åŠ äº†10mmçš„ä¸Šè¾¹è·ï¼Œä½¿å§“åå‘ä¸‹ç§»åŠ¨10æ¯«ç±³ */
            line-height: 1;
            color: #000000;
            width: 100%;
        }
        
        .mode2-pinyin {
            font-size: 26px;
            text-align: center;
            font-weight: bold;
            font-family: Arial, sans-serif;
            color: #000000;
            width: 100%;
            margin: 2mm 0 10px 0; /* æ·»åŠ äº†2mmçš„ä¸Šè¾¹è·ï¼Œä½¿æ‹¼éŸ³å‘ä¸‹ç§»åŠ¨ */
            line-height: 1;
        }
        
        /* æ¨¡å¼äºŒï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode2-name.two-chars {
            letter-spacing: 0.3em; /* å‡å°å­—é—´è·ï¼Œä½¿ä¸¤ä¸ªå­—æ›´åŠ å±…ä¸­ */
            text-align: center;
            width: 100%;
            margin-top: 10mm; /* ä¿æŒä¸æ™®é€šåå­—ä¸€è‡´çš„ä¸Šè¾¹è· */
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding-left: 0.15em; /* è°ƒæ•´å·¦å†…è¾¹è·ä»¥è¡¥å¿å­—é—´è· */
        }
        
        /* æ¨¡å¼ä¸‰ï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode3-name.two-chars {
            /* åŸºç¡€æ ·å¼ä¼šè¢«JavaScriptå†…è”æ ·å¼è¦†ç›– */
            text-align: center;
            width: 100%;
        }
        
        /* æ¨¡å¼ä¸‰ï¼šè‹±æ–‡åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode3-name.english-name {
            text-align: center;
            width: 80%;
            max-width: 180mm;
            word-wrap: break-word;
            word-break: normal;
            white-space: pre-wrap;
            margin: 0 auto;
            padding: 0 10mm;
        }
        
        .mode3-horizontal-line {
            position: absolute;
            width: 100%;
            height: 2.5px;
            background-color: #aaaaaa;
            left: 0;
            z-index: 1;
        }
        
        /* è°ƒæ•´æ¨¡å¼ä¸‰çš„ä½ç½® - ä¸‰ä¸ªå­—åŠä»¥ä¸Šçš„å¤„ç† */
        .mode3-name.left {
            top: 89mm; /* ä»30%è½¬æ¢ä¸º89mm (297mm * 0.3) */
            left: 50%;
            transform: translate(-50%, -50%) rotate(180deg);
        }
        
        .mode3-name.right {
            bottom: 89mm; /* ä»30%è½¬æ¢ä¸º89mm (297mm * 0.3) */
            left: 50%;
            transform: translate(-50%, 50%);
        }
        
        /* æ¨¡å¼ä¸‰æ ·å¼ */
        .mode3-page {
            position: relative;
            width: 210mm; /* çºµå‘A4å®½åº¦ */
            height: 297mm; /* çºµå‘A4é«˜åº¦ */
            background: white;
            page-break-after: always;
            margin: 0 auto 10mm auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 20px var(--shadow-color);
            page-break-inside: avoid;
            break-inside: avoid;
            border-radius: 2px;
            box-sizing: border-box;
            max-width: 100%;
        }
        
        .mode3-name {
            position: absolute;
            font-size: 140px;
            font-weight: bold;
            transform-origin: center;
            text-align: center;
            width: 100%;
            color: #000000;
            margin: 0;
            padding: 0;
        }
        
        /* æ¨¡å¼å››æ ·å¼ */
        .mode4-page {
            position: relative;
            width: 210mm; /* çºµå‘A4å®½åº¦ */
            height: 297mm; /* çºµå‘A4é«˜åº¦ */
            background: white;
            page-break-after: always;
            margin: 0 auto 10mm auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 20px var(--shadow-color);
            page-break-inside: avoid;
            break-inside: avoid;
            border-radius: 2px;
            box-sizing: border-box;
            max-width: 100%;
        }
        
        .mode4-name {
            position: absolute;
            font-size: 140px;
            font-weight: bold;
            transform-origin: center;
            text-align: center;
            width: 100%;
            color: #000000;
            margin: 0;
            padding: 0;
        }
        
        /* æ¨¡å¼å››ä¸“ç”¨ï¼šè‹±æ–‡åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode4-name.english-name {
            text-align: center;
            width: 80%;
            max-width: 180mm;
            word-wrap: break-word;
            word-break: normal;
            white-space: pre-wrap;
            margin: 0 auto;
            padding: 0 10mm;
        }
        
        /* æ¨¡å¼å››ä¸“ç”¨ï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode4-name.two-chars {
            text-align: center;
            width: 100%;
        }
        
        /* æ¨¡å¼å››æ¨ªçº¿æ ·å¼ */
        .mode4-horizontal-line {
            position: absolute;
            width: 100%;
            height: 1px;
            background-color: #aaaaaa;
            left: 0;
            z-index: 1;
        }
        
        /* æ¨¡å¼å›› Logo æ ·å¼ */
        .mode4-logo {
            position: absolute;
            height: 14mm; /* å›ºå®šé«˜åº¦ */
            z-index: 1;
        }
        
        /* æ¨¡å¼å››åå­—ä½ç½®è°ƒæ•´ */
        .mode4-name.left {
            position: absolute;
            top: 30%; /* è°ƒæ•´ä¸Šæ–¹åå­—çš„ä½ç½® */
            left: 50%;
            transform: translate(-50%, -50%) rotate(180deg);
        }
        
        .mode4-name.right {
            position: absolute;
            bottom: 30%; /* è°ƒæ•´ä¸‹æ–¹åå­—çš„ä½ç½® */
            left: 50%;
            transform: translate(-50%, 50%);
        }
        
        /* æ¨¡å¼äº”æ ·å¼ */
        .mode5-page {
            position: relative;
            width: 210mm; /* çºµå‘A4å®½åº¦ */
            height: 297mm; /* çºµå‘A4é«˜åº¦ */
            background: white;
            page-break-after: always;
            margin: 0 auto 10mm auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 20px var(--shadow-color);
            page-break-inside: avoid;
            break-inside: avoid;
            border-radius: 2px;
            box-sizing: border-box;
            max-width: 100%;
        }
        
        .mode5-name {
            position: absolute;
            font-size: 160px;
            font-weight: bold;
            transform-origin: center;
            text-align: center;
            width: 100%;
            color: #000000;
            margin: 0;
            padding: 0;
        }
        
        /* æ¨¡å¼äº”ä¸“ç”¨ï¼šè‹±æ–‡åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode5-name.english-name {
            text-align: center;
            width: 80%;
            max-width: 180mm;
            word-wrap: break-word;
            word-break: normal;
            white-space: pre-wrap;
            margin: 0 auto;
            padding: 0 10mm;
        }
        
        /* æ¨¡å¼äº”ä¸“ç”¨ï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode5-name.two-chars {
            text-align: center;
            width: 100%;
        }
        
        /* æ¨¡å¼äº”æ¨ªçº¿æ ·å¼ */
        .mode5-horizontal-line {
            position: absolute;
            width: 100%;
            height: 1px;
            background-color: #aaaaaa;
            border-top: 1px dashed #aaaaaa;
            background: none;
            left: 0;
            z-index: 1;
        }
        
        /* æ¨¡å¼äº” Logo æ ·å¼ */
        .mode5-logo {
            position: absolute;
            height: 14mm; /* å›ºå®šé«˜åº¦ */
            z-index: 1;
        }
        
        /* æ¨¡å¼äº”åå­—ä½ç½®è°ƒæ•´ */
        .mode5-name.left {
            position: absolute;
            top: 32%; /* è°ƒæ•´ä¸Šæ–¹åå­—çš„ä½ç½® */
            left: 50%;
            transform: translate(-50%, -50%) rotate(180deg);
        }
        
        .mode5-name.right {
            position: absolute;
            bottom: 32%; /* è°ƒæ•´ä¸‹æ–¹åå­—çš„ä½ç½® */
            left: 50%;
            transform: translate(-50%, 50%);
        }
        
        /* æ¨¡å¼äº”ä¸“ç”¨æ ·å¼ï¼šå°å­—è¯´æ˜æ–‡æœ¬ */
        .mode5-text {
            position: absolute;
            width: 100%;
            font-size: 14px;
            text-align: center;
            color: #000000;
            z-index: 2;
            font-weight: normal;
        }
        
        @page {
            size: A4;
            margin: 0;
            orphans: 0;
            widows: 0;
        }
        @media print {
            body { margin: 0; padding: 0; background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .container { max-width: none; margin: 0; padding: 0; box-shadow: none; background-color: white; }
            h1, .input-area, .toolbar { display: none; }
            .preview-area {
                width: 210mm;
                margin: 0;
                border: none;
                box-shadow: none;
                background-color: white;
                padding: 0;
                overflow: visible;
                display: block;
                page-break-before: avoid;
                break-before: avoid;
            }
            .page, .mode3-page, .mode4-page, .mode5-page {
                margin: 0;
                border: none;
                box-shadow: none;
                margin-bottom: 0;
                page-break-inside: avoid;
                break-inside: avoid;
                box-sizing: border-box;
            }
            .page:not(:last-child) {
                page-break-after: always;
                break-after: page;
                height: 297mm;
            }
            .page:last-child {
                page-break-after: avoid;
                break-after: avoid;
                height: 297mm;
                box-sizing: border-box;
            }
            .page:not(:last-child):after {
                display: none;
            }

        }
        
        /* æ¨¡å¼ä¸€ï¼šé¡¶éƒ¨logoæ ·å¼ */
        .top-logo {
            display: none; /* ä¸å†ä½¿ç”¨ */
        }
        
        /* æ¨¡å¼ä¸€ï¼šåº•éƒ¨logoæ ·å¼ */
        .mode1-logo:not(.top-logo) {
            display: none; /* ä¸å†ä½¿ç”¨ */
        }
        
        /* æ¨¡å¼ä¸€ï¼šåº•éƒ¨è£…é¥°å›¾ç‰‡æ ·å¼ */
        .mode1-card-image {
            display: none; /* ä¸å†ä½¿ç”¨ */
        }
        
        /* ä¸ºæ¯ä¸ªåç‰Œä½ç½®è®¾ç½®logoå’Œåº•éƒ¨å›¾ç‰‡ä½ç½® - ä¸å†ä½¿ç”¨ */
        .logo-1, .logo-2, .logo-3,
        .card-image-1, .card-image-2, .card-image-3 {
            display: none;
        }
        
        /* ä¸ºæ¯ä¸ªåç‰Œä½ç½®è®¾ç½®èƒŒæ™¯å›¾ç‰‡ä½ç½® */
        .bg-image-1 {
            top: 0;
        }
        
        .bg-image-2 {
            top: 99mm;
        }
        
        .bg-image-3 {
            top: 202mm; /* è®¾ç½®ä¸º297mm - 99mmï¼Œç¡®ä¿åº•éƒ¨å¯¹é½ */
            height: 99mm;
        }
        
        /* æ¨¡å¼å…­æ ·å¼ - å¤åˆ¶æ¨¡å¼äºŒçš„æ ·å¼ */
        .mode6-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(4, 1fr);
            width: 100%;
            height: 100%;
            position: relative;
            gap: 0;
        }
        
        /* æ·»åŠ æ°´å¹³åˆ†å‰²çº¿ */
        .mode6-grid::before {
            content: '';
            position: absolute;
            top: 25%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        .mode6-grid::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ·»åŠ ç¬¬ä¸‰æ¡æ°´å¹³çº¿ */
        .mode6-horizontal-line {
            position: absolute;
            top: 75%;
            left: 0;
            right: 0;
            height: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ·»åŠ å‚ç›´åˆ†å‰²çº¿ */
        .mode6-vertical-line {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 2.5px;
            background-color: #aaaaaa;
            z-index: 2;
        }
        
        /* æ¨¡å¼å…­ï¼šæ·»åŠ logoæ ·å¼ */
        .mode6-logo {
            position: absolute;
            top: 6.5mm;
            left: 6.5mm;
            height: 34px; /* åŸæ¥30pxçš„1.1å€ */
            z-index: 2;
        }
        
        /* ç¡®ä¿mode6-cardä¿æŒç›¸å¯¹å®šä½ */
        .mode6-card {
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 5mm 5mm;
            box-sizing: border-box;
            height: 100%;
            width: 100%;
        }
        
        .mode6-name {
            font-size: 80px;
            font-weight: bold;
            text-align: center;
            margin: 5mm 0 5px 0;
            line-height: 1;
            color: #000000;
            width: 100%;
        }
        
        .mode6-pinyin {
            font-size: 16px;
            text-align: center;
            font-weight: bold;
            font-family: Arial, sans-serif;
            color: #000000;
            width: 100%;
            margin: 0 0 5px 0;
            line-height: 1;
        }
        
        /* æ¨¡å¼å…­ï¼šä¸¤ä¸ªå­—åå­—çš„ç‰¹æ®Šæ ·å¼ */
        .mode6-name.two-chars {
            letter-spacing: 0.3em;
            text-align: center;
            width: 100%;
            margin-top: 10mm;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding-left: 0.15em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><img src="pixar-lamp.svg" alt="çš®å…‹æ–¯å°è·³ç¯" style="height: 4rem; margin-right: 10px;">ä¼šè®®åç‰Œç”Ÿæˆå™¨</h1>
        <!-- ç§»é™¤é¡¶éƒ¨å·¥å…·æ ï¼ŒæŒ‰é’®å°†ç§»è‡³ä¸‹æ–¹ -->
        <div class="input-area">
            <label class="input-label">è¯·è¾“å…¥å§“åï¼Œç”¨ä¸­æ–‡é¡¿å·ï¼ˆã€ï¼‰åˆ†éš”ï¼š</label>
            <textarea id="namesInput" placeholder="ä¾‹å¦‚ï¼šå¼ ä¸‰ã€æå››ã€ç‹äº”"></textarea>
            <div class="form-group" style="margin-bottom: 15px;">
                <label class="input-label">é€‰æ‹©æ’ç‰ˆæ¨¡å¼ï¼š</label>
                <select id="layoutMode" style="padding: 10px; border-radius: var(--radius-sm); border: 1px solid var(--border-color); width: 100%; font-size: 16px; background-color: var(--input-bg);">
                    <option value="mode1">æ¨¡å¼ä¸€ï¼ˆå•è¡Œå¤§å­—ï¼‰</option>
                    <option value="mode2">æ¨¡å¼äºŒï¼ˆä¸­æ–‡+æ‹¼éŸ³ï¼‰</option>
                    <option value="mode3">æ¨¡å¼ä¸‰ï¼ˆå¯¹ç§°æ—‹è½¬ï¼‰</option>
                    <option value="mode4">æ¨¡å¼å››ï¼ˆå¸¦æ¨ªçº¿æ ‡è®°ï¼‰</option>
                    <option value="mode5">æ¨¡å¼äº”ï¼ˆæ±‡å·ä¹¦é™¢è®²å¸ˆå¸­å¡ï¼‰</option>
                    <option value="mode6">æ¨¡å¼å…­ï¼ˆæ±‡å·ä¹¦é™¢å­¦å‘˜èƒ¸è´´ï¼‰</option>
                </select>
            </div>
            
            <!-- æ¨¡å¼å…­åº•éƒ¨æ–‡å­—è¾“å…¥ -->
            <div id="mode6SubtextContainer" class="form-group" style="margin-bottom: 15px; display: none;">
                <label class="input-label">æ¨¡å¼å…­åº•éƒ¨æ–‡å­—ï¼š</label>
                <input type="text" id="mode6Subtext" placeholder="è¯·è¾“å…¥åº•éƒ¨å°å­—å†…å®¹ï¼Œå¦‚ï¼šæ±‡å·ä¹¦é™¢æ–°å‘˜å·¥å¯¼å¸ˆç‰¹è®­è¥" value="" style="padding: 10px; border-radius: var(--radius-sm); border: 1px solid var(--border-color); width: 100%; font-size: 16px; background-color: var(--input-bg);">
            </div>
            
            <div class="button-group">
                <button id="previewButton">ç”Ÿæˆé¢„è§ˆ</button>
                <button id="printButton" style="background-color: var(--secondary-color);">æ‰“å°</button>
                <button id="pdfButton" style="background-color: var(--secondary-color);">ä¿å­˜PDF</button>
            </div>
        </div>
        <div id="previewArea" class="preview-area"></div>
    </div>
    <script>
        // æ·»åŠ å˜é‡è·Ÿè¸ªæ’ç‰ˆæ¨¡å¼æ˜¯å¦å·²åˆ‡æ¢ä½†æœªé¢„è§ˆ
        let layoutChanged = false;
        let currentLayoutMode = document.getElementById('layoutMode').value;
        
        function savePDF() {
            // åœ¨æ‰“å°å‰æ¸…ç†å¯èƒ½å¯¼è‡´ç©ºç™½é¡µçš„å…ƒç´ 
            const pages = document.querySelectorAll('.page, .mode3-page');
            // ç¡®ä¿æœ€åä¸€é¡µä¸ä¼šå¯¼è‡´é¢å¤–çš„åˆ†é¡µ
            if (pages.length > 0) {
                pages[pages.length - 1].style.pageBreakAfter = 'avoid';
                pages[pages.length - 1].style.breakAfter = 'avoid';
            }
            // ç§»é™¤æ‰€æœ‰çˆ±å¿ƒæ³¡æ³¡å…ƒç´ ï¼Œé¿å…å®ƒä»¬å‡ºç°åœ¨æ‰“å°é¡µé¢ä¸Š
            document.querySelectorAll('.heart').forEach(heart => heart.remove());
            window.print();
        }
        
        // ä¸ºæ‰“å°æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('printButton').addEventListener('click', function() {
            // æ·»åŠ æŒ‰é’®ç‚¹å‡»æ•ˆæœ
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'translateY(-2px)';
            }, 150);
            
            // æ·»åŠ çˆ±å¿ƒæ³¡æ³¡æ•ˆæœ
            createHearts(this);
            
            // æ£€æŸ¥é¢„è§ˆåŒºåŸŸæ˜¯å¦ä¸ºç©º
            const previewArea = document.getElementById('previewArea');
            if (previewArea.innerHTML.trim() === '' || previewArea.innerHTML.includes('è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå§“å')) {
                // æ˜¾ç¤ºæç¤ºä¿¡æ¯
                alert('è¯·å…ˆç”Ÿæˆé¢„è§ˆï¼ŒæŸ¥çœ‹æ•ˆæœåå†æ‰“å°ï¼');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦åˆ‡æ¢äº†æ’ç‰ˆæ¨¡å¼ä½†æœªç”Ÿæˆé¢„è§ˆ
            if (layoutChanged) {
                alert('æ’ç‰ˆå¸ƒå±€åˆ‡æ¢åï¼Œè¯·å…ˆç”Ÿæˆé¢„è§ˆæŸ¥çœ‹æ•ˆæœ');
                return;
            }
            
            // å»¶è¿Ÿæ‰§è¡Œæ‰“å°åŠŸèƒ½ï¼Œç¡®ä¿åŠ¨ç”»æ•ˆæœæœ‰æ—¶é—´æ˜¾ç¤º
            setTimeout(() => {
                // ç§»é™¤æ‰€æœ‰çˆ±å¿ƒæ³¡æ³¡å…ƒç´ ï¼Œé¿å…å®ƒä»¬å‡ºç°åœ¨æ‰“å°é¡µé¢ä¸Š
                document.querySelectorAll('.heart').forEach(heart => heart.remove());
                window.print();
            }, 300);
        });
        
        // ä¸ºä¿å­˜PDFæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('pdfButton').addEventListener('click', function() {
            // æ·»åŠ æŒ‰é’®ç‚¹å‡»æ•ˆæœ
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'translateY(-2px)';
            }, 150);
            
            // æ·»åŠ çˆ±å¿ƒæ³¡æ³¡æ•ˆæœ
            createHearts(this);
            
            // æ£€æŸ¥é¢„è§ˆåŒºåŸŸæ˜¯å¦ä¸ºç©º
            const previewArea = document.getElementById('previewArea');
            if (previewArea.innerHTML.trim() === '' || previewArea.innerHTML.includes('è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå§“å')) {
                // æ˜¾ç¤ºæç¤ºä¿¡æ¯
                alert('è¯·å…ˆç”Ÿæˆé¢„è§ˆï¼ŒæŸ¥çœ‹æ•ˆæœåå†ä¿å­˜PDFï¼');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦åˆ‡æ¢äº†æ’ç‰ˆæ¨¡å¼ä½†æœªç”Ÿæˆé¢„è§ˆ
            if (layoutChanged) {
                alert('æ’ç‰ˆå¸ƒå±€åˆ‡æ¢åï¼Œè¯·å…ˆç”Ÿæˆé¢„è§ˆæŸ¥çœ‹æ•ˆæœ');
                return;
            }
            
            // å»¶è¿Ÿæ‰§è¡Œä¿å­˜PDFåŠŸèƒ½ï¼Œç¡®ä¿åŠ¨ç”»æ•ˆæœæœ‰æ—¶é—´æ˜¾ç¤º
            setTimeout(() => {
                // ç§»é™¤æ‰€æœ‰çˆ±å¿ƒæ³¡æ³¡å…ƒç´ ï¼Œé¿å…å®ƒä»¬å‡ºç°åœ¨æ‰“å°é¡µé¢ä¸Š
                document.querySelectorAll('.heart').forEach(heart => heart.remove());
                savePDF();
            }, 300);
        });
        
        // æ·»åŠ è¾“å…¥æ¡†ç„¦ç‚¹æ•ˆæœ
        document.getElementById('namesInput').addEventListener('focus', function() {
            this.parentElement.style.boxShadow = '0 0 0 3px rgba(76, 175, 80, 0.1)';
        });
        
        document.getElementById('namesInput').addEventListener('blur', function() {
            this.parentElement.style.boxShadow = 'none';
        });
        // åˆ›å»ºçˆ±å¿ƒæ³¡æ³¡æ•ˆæœå‡½æ•°
        function createHearts(element) {
            const heartsCount = 10;
            // è·å–æŒ‰é’®ç›¸å¯¹äºè§†å£çš„ä½ç½®
            const rect = element.getBoundingClientRect();
            // è·å–æŒ‰é’®åœ¨é¡µé¢ä¸­çš„ç»å¯¹ä½ç½®
            const buttonX = rect.left + window.scrollX;
            const buttonY = rect.top + window.scrollY;
            
            // åˆ›å»ºè¡¨æƒ…ç¬¦å·æ•°ç»„
            const characters = ['ğŸ‘'];
            
            for (let i = 0; i < heartsCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                // éšæœºé€‰æ‹©ä¸€ä¸ªæ±‰å­—
                const randomIndex = Math.floor(Math.random() * characters.length);
                heart.innerHTML = characters[randomIndex];
                
                // éšæœºä½ç½®å’Œå»¶è¿Ÿ
                const offsetX = (Math.random() - 0.5) * 200;
                const offsetY = (Math.random() - 0.5) * 50;
                const delay = Math.random() * 0.8;
                
                // è®¾ç½®åˆå§‹ä½ç½® - ä½¿ç”¨æŒ‰é’®çš„ç»å¯¹ä½ç½®
                heart.style.left = (buttonX + element.offsetWidth / 2 + offsetX) + 'px';
                heart.style.top = (buttonY + element.offsetHeight / 2 + offsetY) + 'px';
                heart.style.animationDelay = delay + 's';
                
                document.body.appendChild(heart);
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    heart.remove();
                }, 1500 + delay * 1000);
            }
        }
        
        // ä¸ºæ’ç‰ˆæ¨¡å¼é€‰æ‹©æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('layoutMode').addEventListener('change', function() {
            // æ£€æµ‹åˆ°æ¨¡å¼å˜åŒ–ï¼Œè®¾ç½®æ ‡å¿—
            if (this.value !== currentLayoutMode) {
                layoutChanged = true;
                currentLayoutMode = this.value;
            }
            
            // æ˜¾ç¤ºæˆ–éšè—æ¨¡å¼å…­åº•éƒ¨æ–‡å­—è¾“å…¥æ¡†
            const mode6SubtextContainer = document.getElementById('mode6SubtextContainer');
            if (this.value === 'mode6') {
                mode6SubtextContainer.style.display = 'block';
            } else {
                mode6SubtextContainer.style.display = 'none';
            }
        });
        
        // åˆå§‹æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºæ¨¡å¼å…­åº•éƒ¨æ–‡å­—è¾“å…¥æ¡†
        window.addEventListener('DOMContentLoaded', function() {
            const layoutMode = document.getElementById('layoutMode').value;
            const mode6SubtextContainer = document.getElementById('mode6SubtextContainer');
            if (layoutMode === 'mode6') {
                mode6SubtextContainer.style.display = 'block';
            }
        });
        
        document.getElementById('previewButton').addEventListener('click', function() {
            // æ·»åŠ æŒ‰é’®ç‚¹å‡»æ•ˆæœ
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'translateY(-2px)';
            }, 150);
            
            // æ·»åŠ çˆ±å¿ƒæ³¡æ³¡æ•ˆæœ
            createHearts(this);
            
            const namesInput = document.getElementById('namesInput').value;
            const names = namesInput.split('ã€').filter(name => name.trim() !== '');
            const previewArea = document.getElementById('previewArea');
            const layoutMode = document.getElementById('layoutMode').value;
            
            // é‡ç½®æ’ç‰ˆæ¨¡å¼å˜åŒ–æ ‡å¿—
            layoutChanged = false;
            currentLayoutMode = layoutMode;
            
            previewArea.innerHTML = '';
            
            // å¦‚æœæ²¡æœ‰è¾“å…¥å§“åï¼Œæ˜¾ç¤ºæç¤º
            if (names.length === 0) {
                previewArea.innerHTML = '<div style="text-align: center; padding: 30px; color: #666;">è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå§“å</div>';
                return;
            }
            
            // å¦‚æœé€‰æ‹©æ¨¡å¼å…­ï¼Œæ£€æŸ¥æ˜¯å¦è¾“å…¥äº†åº•éƒ¨æ–‡å­—
            if (layoutMode === 'mode6') {
                const mode6SubtextInput = document.getElementById('mode6Subtext');
                if (!mode6SubtextInput || !mode6SubtextInput.value.trim()) {
                    alert('è¯·è¾“å…¥æ¨¡å¼å…­åº•éƒ¨æ˜¾ç¤ºçš„æ–‡å­—å†…å®¹');
                    return;
                }
            }

            // æ ¹æ®é€‰æ‹©çš„æ¨¡å¼ç”Ÿæˆä¸åŒçš„é¢„è§ˆ
            if (layoutMode === 'mode1') {
                // æ¨¡å¼ä¸€ï¼šæ¯é¡µ3ä¸ªå¤§å­—åç‰Œ
                for (let i = 0; i < names.length; i += 3) {
                    const page = document.createElement('div');
                    page.className = 'page';
                    page.style.position = 'relative';
                    page.style.width = '210mm';
                    page.style.height = '297mm';
                    page.style.background = 'white';
                    
                    // è®¡ç®—å½“å‰é¡µé¢åº”è¯¥åŒ…å«çš„åå­—æ•°é‡
                    const namesInThisPage = Math.min(3, names.length - i);
                    
                    // åªæœ‰å½“æœ‰åå­—è¦æ˜¾ç¤ºæ—¶æ‰åˆ›å»ºé¡µé¢
                    if (namesInThisPage > 0) {
                        for (let j = 0; j < namesInThisPage; j++) {
                            // æ·»åŠ èƒŒæ™¯å›¾ç‰‡
                            const bgImage = document.createElement('img');
                            bgImage.src = 'pic4.png';
                            bgImage.className = `mode1-bg-image bg-image-${j+1}`;
                            page.appendChild(bgImage);
                            
                            // æ·»åŠ åå­—
                            const nameDiv = document.createElement('div');
                            nameDiv.className = 'name';
                            const nameText = names[i + j].trim();
                            nameDiv.textContent = nameText;
                            
                            // å¦‚æœæ˜¯ä¸¤ä¸ªå­—çš„åå­—ï¼Œæ·»åŠ ç‰¹æ®Šæ ·å¼ç±»
                            if (nameText.length === 2) {
                                nameDiv.classList.add('two-chars');
                            }
                            
                            // æ·»åŠ å‘½åç±»
                            nameDiv.classList.add(`name-${j+1}`);
                            
                            // æ·»åŠ åå­—åˆ°é¡µé¢
                            page.appendChild(nameDiv);
                        }
                        
                        previewArea.appendChild(page);
                    }
                }
            } else if (layoutMode === 'mode3') {
                // æ¨¡å¼ä¸‰ï¼šæ¨ªå‘A4çº¸å¯¹ç§°æ—‹è½¬å¸ƒå±€ï¼Œæ¯é¡µä¸€ä¸ªåå­—
                for (let i = 0; i < names.length; i++) {
                    const page = document.createElement('div');
                    page.className = 'mode3-page';
                    
                    const nameText = names[i].trim();
                    
                    // æ·»åŠ ä¸Šæ–¹å›¾ç‰‡ï¼ˆcard2.pngï¼‰- å‘ä¸‹ç§»åŠ¨48æ¯«ç±³
                    const topImage = document.createElement('img');
                    topImage.src = 'card2.png';
                    topImage.style.position = 'absolute';
                    topImage.style.top = '48mm';
                    topImage.style.left = '0';
                    topImage.style.width = '100%';
                    topImage.style.zIndex = '1';
                    page.appendChild(topImage);
                    
                    // æ·»åŠ ä¸‹æ–¹å›¾ç‰‡ï¼ˆpic4.pngï¼‰- å‘ä¸Šç§»åŠ¨48æ¯«ç±³
                    const bottomImage = document.createElement('img');
                    bottomImage.src = 'pic4.png';
                    bottomImage.style.position = 'absolute';
                    bottomImage.style.bottom = '48mm';
                    bottomImage.style.left = '0';
                    bottomImage.style.width = '100%';
                    bottomImage.style.zIndex = '1';
                    page.appendChild(bottomImage);
                    
                    // åˆ›å»ºä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬180åº¦ï¼‰
                    const leftName = document.createElement('div');
                    leftName.className = 'mode3-name left';
                    leftName.textContent = nameText;
                    leftName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // ä¸ºæ‰€æœ‰é¡µé¢ç»Ÿä¸€è®¾ç½®ä¸Šæ–¹åå­—çš„ä½ç½®
                    leftName.style.top = 'calc(30% + 17mm)'; // å‘ä¸‹ç§»åŠ¨20æ¯«ç±³
                    leftName.style.left = '50%';
                    leftName.style.width = '100%';
                    leftName.style.textAlign = 'center';
                    
                    // åˆ›å»ºä¸‹æ–¹åå­—ï¼ˆæ­£å¸¸æ–¹å‘ï¼‰
                    const rightName = document.createElement('div');
                    rightName.className = 'mode3-name right';
                    rightName.textContent = nameText;
                    rightName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // ä¸ºæ‰€æœ‰é¡µé¢ç»Ÿä¸€è®¾ç½®ä¸‹æ–¹åå­—çš„ä½ç½®
                    rightName.style.bottom = 'calc(30% + 17mm)'; // å‘ä¸Šç§»åŠ¨20æ¯«ç±³
                    rightName.style.left = '50%';
                    rightName.style.width = '100%';
                    rightName.style.textAlign = 'center';
                    
                    // æ£€æµ‹æ˜¯å¦ä¸ºè‹±æ–‡åå­—ï¼ˆåŒ…å«è‹±æ–‡å­—æ¯æˆ–ç©ºæ ¼ï¼‰
                    const isEnglishName = /[a-zA-Z\s]/.test(nameText);
                    
                    // å¦‚æœæ˜¯è‹±æ–‡åå­—ä¸”è¾ƒé•¿ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
                    if (isEnglishName) {
                        // æ·»åŠ è‹±æ–‡åå­—æ ‡è¯†ç±»
                        leftName.classList.add('english-name');
                        rightName.classList.add('english-name');
                        
                        // æ ¹æ®åå­—é•¿åº¦åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        let fontSize = 110; // é»˜è®¤å­—ä½“å¤§å°
                        let lineHeight = 1.2; // é»˜è®¤è¡Œé«˜
                        
                        // è§£æåå­—ï¼Œå¤„ç†å¯èƒ½åŒ…å«è¿å­—ç¬¦çš„æƒ…å†µ
                        const nameWords = nameText.split(/[\s-]+/).filter(word => word.trim() !== '');
                        const totalLength = nameText.length;
                        const wordCount = nameWords.length;
                        
                        // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        if (totalLength > 20 || wordCount >= 4) {
                            fontSize = 60; // éå¸¸é•¿çš„åå­—
                            lineHeight = 1.1;
                        } else if (totalLength > 15 || wordCount >= 3) {
                            fontSize = 75; // è¾ƒé•¿çš„åå­—
                            lineHeight = 1.15;
                        } else if (totalLength > 10 || wordCount >= 2) {
                            fontSize = 90; // ä¸­ç­‰é•¿åº¦çš„åå­—
                        }
                        
                        // åº”ç”¨å­—ä½“å¤§å°å’Œè¡Œé«˜
                        leftName.style.fontSize = `${fontSize}px`;
                        rightName.style.fontSize = `${fontSize}px`;
                        leftName.style.lineHeight = lineHeight.toString();
                        rightName.style.lineHeight = lineHeight.toString();
                        
                        // å¯ç”¨è‡ªåŠ¨æ¢è¡Œ
                        leftName.style.whiteSpace = 'pre-wrap';
                        rightName.style.whiteSpace = 'pre-wrap';
                        
                        // è°ƒæ•´ä½ç½®ï¼Œç¡®ä¿æ–‡æœ¬å±…ä¸­æ˜¾ç¤º
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                        
                        // æ ¹æ®åå­—é•¿åº¦å’Œç»“æ„å†³å®šå¦‚ä½•åˆ†è¡Œæ˜¾ç¤º
                        let formattedText = nameText;
                        
                        // ç‰¹æ®Šå¤„ç†ç±»ä¼¼äº"Schaerer-Lim Mei Qin Genevieve"è¿™æ ·çš„æ ¼å¼
                        if (nameText.includes('-') || wordCount >= 3) {
                            // æ‰¾åˆ°åˆé€‚çš„åˆ†è¡Œç‚¹
                            const midPoint = Math.min(Math.ceil(nameText.length / 2), nameText.indexOf(' ', nameText.length / 3));
                            
                            if (midPoint > 0) {
                                // å°†åå­—åˆ†ä¸ºä¸¤è¡Œï¼Œå°½é‡ä¿æŒæ¯è¡Œé•¿åº¦å¹³è¡¡
                                const firstPart = nameText.substring(0, midPoint);
                                const secondPart = nameText.substring(midPoint).trim();
                                formattedText = `${firstPart}\n${secondPart}`;
                            } else {
                                // å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„åˆ†è¡Œç‚¹ï¼ŒæŒ‰ç…§å•è¯æ•°é‡åˆ†è¡Œ
                                const midWordIndex = Math.ceil(wordCount / 2);
                                const firstLine = nameWords.slice(0, midWordIndex).join(' ');
                                const secondLine = nameWords.slice(midWordIndex).join(' ');
                                formattedText = `${firstLine}\n${secondLine}`;
                            }
                        }
                        
                        leftName.textContent = formattedText;
                        rightName.textContent = formattedText;
                    }
                    // å¦‚æœæ˜¯ä¸¤ä¸ªå­—çš„ä¸­æ–‡åå­—ï¼Œæ·»åŠ ç‰¹æ®Šå¤„ç†
                    else if (nameText.length === 2) {
                        leftName.classList.add('two-chars');
                        rightName.classList.add('two-chars');
                        
                        // å¯¹ä¸¤ä¸ªå­—çš„åå­—åº”ç”¨å®Œå…¨è‡ªå®šä¹‰çš„æ ·å¼
                        leftName.style.letterSpacing = '0.8em';
                        rightName.style.letterSpacing = '0.8em';
                        
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // ä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬çš„ï¼‰éœ€è¦ç‹¬ç«‹è°ƒæ•´
                        leftName.style.transform = 'translate(calc(-50% - 0.4em), -50%) rotate(180deg)';
                        
                        // ä¸‹æ–¹åå­—ä¹Ÿéœ€è¦åŒæ ·çš„æ°´å¹³è°ƒæ•´ï¼Œä¿æŒç›¸åŒçš„åç§»è¡¥å¿
                        rightName.style.transform = 'translate(calc(-50% + 0.4em), 50%)';
                    } else {
                        // ä¸‰ä¸ªå­—åŠä»¥ä¸Šçš„ä¸­æ–‡åå­—å¤„ç†
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // åº”ç”¨æ–°çš„transform
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                    }
                    
                    // æ·»åŠ å…ƒç´ åˆ°é¡µé¢
                    page.appendChild(leftName);
                    page.appendChild(rightName);
                    
                    // æ·»åŠ é¡µé¢åˆ°é¢„è§ˆåŒºåŸŸ
                    previewArea.appendChild(page);
                }
            } else if (layoutMode === 'mode2') {
                // æ¨¡å¼äºŒï¼šç½‘æ ¼å¸ƒå±€ï¼Œæ¯é¡µ8ä¸ªåç‰Œï¼ˆä¸­æ–‡+æ‹¼éŸ³ï¼‰
                for (let i = 0; i < names.length; i += 8) {
                    const page = document.createElement('div');
                    page.className = 'page';
                    page.style.position = 'relative';
                    page.style.width = '210mm';
                    page.style.height = '297mm';
                    
                    const grid = document.createElement('div');
                    grid.className = 'mode2-grid';
                    page.appendChild(grid);
                    
                    // æ·»åŠ æ°´å¹³å’Œå‚ç›´åˆ†å‰²çº¿
                    const horizontalLine = document.createElement('div');
                    horizontalLine.className = 'horizontal-line';
                    grid.appendChild(horizontalLine);
                    
                    const verticalLine = document.createElement('div');
                    verticalLine.className = 'vertical-line';
                    grid.appendChild(verticalLine);
                    
                    // è®¡ç®—å½“å‰é¡µé¢åº”è¯¥åŒ…å«çš„åå­—æ•°é‡
                    const namesInThisPage = Math.min(8, names.length - i);
                    
                    // åˆ›å»ºåç‰Œ
                    for (let j = 0; j < namesInThisPage; j++) {
                        const name = names[i + j].trim();
                        const pinyin = toPinyin(name);
                        
                        const card = createMode2Card(name, pinyin);
                        
                        grid.appendChild(card);
                    }
                    
                    previewArea.appendChild(page);
                }
            } else if (layoutMode === 'mode4') {
                // æ¨¡å¼å››ï¼šçºµå‘A4çº¸å¯¹ç§°æ—‹è½¬å¸ƒå±€ï¼Œæ¯é¡µä¸€ä¸ªåå­—ï¼Œæœ‰æ¨ªçº¿å’Œlogo
                for (let i = 0; i < names.length; i++) {
                    const page = document.createElement('div');
                    page.className = 'mode4-page';
                    
                    const nameText = names[i].trim();
                    
                    // æ·»åŠ é¡¶éƒ¨æ¨ªçº¿
                    const topLine = document.createElement('div');
                    topLine.className = 'mode4-horizontal-line';
                    topLine.style.top = '50mm';
                    page.appendChild(topLine);
                    
                    // æ·»åŠ ä¸­é—´æ¨ªçº¿
                    const middleLine = document.createElement('div');
                    middleLine.className = 'mode4-horizontal-line';
                    middleLine.style.top = '50%';
                    page.appendChild(middleLine);
                    
                    // æ·»åŠ åº•éƒ¨æ¨ªçº¿
                    const bottomLine = document.createElement('div');
                    bottomLine.className = 'mode4-horizontal-line';
                    bottomLine.style.bottom = '50mm';
                    page.appendChild(bottomLine);

                    
                    
                    // æ·»åŠ å·¦ä¸Šè§’logo
                    const topLeftLogo = document.createElement('img');
                    topLeftLogo.src = 'INOVANCE-logo.png';
                    topLeftLogo.className = 'mode4-logo';
                    topLeftLogo.style.top = '160mm';
                    topLeftLogo.style.left = '15mm';
                    page.appendChild(topLeftLogo);
                    
                    // æ·»åŠ å³ä¸‹è§’logo - æ—‹è½¬180åº¦
                    const bottomRightLogo = document.createElement('img');
                    bottomRightLogo.src = 'INOVANCE-logo.png';
                    bottomRightLogo.className = 'mode4-logo';
                    bottomRightLogo.style.bottom = '160mm';
                    bottomRightLogo.style.right = '15mm';
                    bottomRightLogo.style.transform = 'rotate(180deg)';
                    page.appendChild(bottomRightLogo);
                    
                    // åˆ›å»ºä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬180åº¦ï¼‰
                    const leftName = document.createElement('div');
                    leftName.className = 'mode4-name left';
                    leftName.textContent = nameText;
                    leftName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // åˆ›å»ºä¸‹æ–¹åå­—ï¼ˆæ­£å¸¸æ–¹å‘ï¼‰
                    const rightName = document.createElement('div');
                    rightName.className = 'mode4-name right';
                    rightName.textContent = nameText;
                    rightName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // æ£€æµ‹æ˜¯å¦ä¸ºè‹±æ–‡åå­—ï¼ˆåŒ…å«è‹±æ–‡å­—æ¯æˆ–ç©ºæ ¼ï¼‰
                    const isEnglishName = /[a-zA-Z\s]/.test(nameText);
                    
                    // å¦‚æœæ˜¯è‹±æ–‡åå­—ä¸”è¾ƒé•¿ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
                    if (isEnglishName) {
                        // æ·»åŠ è‹±æ–‡åå­—æ ‡è¯†ç±»
                        leftName.classList.add('english-name');
                        rightName.classList.add('english-name');
                        
                        // æ ¹æ®åå­—é•¿åº¦åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        let fontSize = 110; // é»˜è®¤å­—ä½“å¤§å°
                        let lineHeight = 1.2; // é»˜è®¤è¡Œé«˜
                        
                        // è§£æåå­—ï¼Œå¤„ç†å¯èƒ½åŒ…å«è¿å­—ç¬¦çš„æƒ…å†µ
                        const nameWords = nameText.split(/[\s-]+/).filter(word => word.trim() !== '');
                        const totalLength = nameText.length;
                        const wordCount = nameWords.length;
                        
                        // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        if (totalLength > 20 || wordCount >= 4) {
                            fontSize = 60; // éå¸¸é•¿çš„åå­—
                            lineHeight = 1.1;
                        } else if (totalLength > 15 || wordCount >= 3) {
                            fontSize = 75; // è¾ƒé•¿çš„åå­—
                            lineHeight = 1.15;
                        } else if (totalLength > 10 || wordCount >= 2) {
                            fontSize = 90; // ä¸­ç­‰é•¿åº¦çš„åå­—
                        }
                        
                        // åº”ç”¨å­—ä½“å¤§å°å’Œè¡Œé«˜
                        leftName.style.fontSize = `${fontSize}px`;
                        rightName.style.fontSize = `${fontSize}px`;
                        leftName.style.lineHeight = lineHeight.toString();
                        rightName.style.lineHeight = lineHeight.toString();
                        
                        // å¯ç”¨è‡ªåŠ¨æ¢è¡Œ
                        leftName.style.whiteSpace = 'pre-wrap';
                        rightName.style.whiteSpace = 'pre-wrap';
                        
                        // è°ƒæ•´ä½ç½®ï¼Œç¡®ä¿æ–‡æœ¬å±…ä¸­æ˜¾ç¤º
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                        
                        // æ ¹æ®åå­—é•¿åº¦å’Œç»“æ„å†³å®šå¦‚ä½•åˆ†è¡Œæ˜¾ç¤º
                        let formattedText = nameText;
                        
                        // ç‰¹æ®Šå¤„ç†ç±»ä¼¼äº"Schaerer-Lim Mei Qin Genevieve"è¿™æ ·çš„æ ¼å¼
                        if (nameText.includes('-') || wordCount >= 3) {
                            // æ‰¾åˆ°åˆé€‚çš„åˆ†è¡Œç‚¹
                            const midPoint = Math.min(Math.ceil(nameText.length / 2), nameText.indexOf(' ', nameText.length / 3));
                            
                            if (midPoint > 0) {
                                // å°†åå­—åˆ†ä¸ºä¸¤è¡Œï¼Œå°½é‡ä¿æŒæ¯è¡Œé•¿åº¦å¹³è¡¡
                                const firstPart = nameText.substring(0, midPoint);
                                const secondPart = nameText.substring(midPoint).trim();
                                formattedText = `${firstPart}\n${secondPart}`;
                            } else {
                                // å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„åˆ†è¡Œç‚¹ï¼ŒæŒ‰ç…§å•è¯æ•°é‡åˆ†è¡Œ
                                const midWordIndex = Math.ceil(wordCount / 2);
                                const firstLine = nameWords.slice(0, midWordIndex).join(' ');
                                const secondLine = nameWords.slice(midWordIndex).join(' ');
                                formattedText = `${firstLine}\n${secondLine}`;
                            }
                        }
                        
                        leftName.textContent = formattedText;
                        rightName.textContent = formattedText;
                    }
                    // å¦‚æœæ˜¯ä¸¤ä¸ªå­—çš„ä¸­æ–‡åå­—ï¼Œæ·»åŠ ç‰¹æ®Šå¤„ç†
                    else if (nameText.length === 2) {
                        leftName.classList.add('two-chars');
                        rightName.classList.add('two-chars');
                        
                        // å¯¹ä¸¤ä¸ªå­—çš„åå­—åº”ç”¨å®Œå…¨è‡ªå®šä¹‰çš„æ ·å¼
                        leftName.style.letterSpacing = '0.8em';
                        rightName.style.letterSpacing = '0.8em';
                        
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // ä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬çš„ï¼‰éœ€è¦ç‹¬ç«‹è°ƒæ•´
                        leftName.style.transform = 'translate(calc(-50% - 0.4em), -50%) rotate(180deg)';
                        
                        // ä¸‹æ–¹åå­—ä¹Ÿéœ€è¦åŒæ ·çš„æ°´å¹³è°ƒæ•´ï¼Œä¿æŒç›¸åŒçš„åç§»è¡¥å¿
                        rightName.style.transform = 'translate(calc(-50% + 0.4em), 50%)';
                    } else {
                        // ä¸‰ä¸ªå­—åŠä»¥ä¸Šçš„ä¸­æ–‡åå­—å¤„ç†
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // åº”ç”¨æ–°çš„transform
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                    }
                    
                    // æ·»åŠ å…ƒç´ åˆ°é¡µé¢
                    page.appendChild(leftName);
                    page.appendChild(rightName);
                    
                    // æ·»åŠ é¡µé¢åˆ°é¢„è§ˆåŒºåŸŸ
                    previewArea.appendChild(page);
                }
            } else if (layoutMode === 'mode5') {
                // æ¨¡å¼äº”ï¼šçºµå‘A4çº¸å¯¹ç§°æ—‹è½¬å¸ƒå±€ï¼Œæ¯é¡µä¸€ä¸ªåå­—ï¼Œæœ‰æ¨ªçº¿å’Œlogo
                for (let i = 0; i < names.length; i++) {
                    const page = document.createElement('div');
                    page.className = 'mode5-page';
                    
                    const nameText = names[i].trim();
                    
                    // æ·»åŠ é¡¶éƒ¨æ¨ªçº¿
                    const topLine = document.createElement('div');
                    topLine.className = 'mode5-horizontal-line';
                    topLine.style.top = '50mm';
                    page.appendChild(topLine);
                    
                    // æ·»åŠ ä¸­é—´æ¨ªçº¿
                    const middleLine = document.createElement('div');
                    middleLine.className = 'mode5-horizontal-line';
                    middleLine.style.top = '50%';
                    page.appendChild(middleLine);
                    
                    // æ·»åŠ åº•éƒ¨æ¨ªçº¿
                    const bottomLine = document.createElement('div');
                    bottomLine.className = 'mode5-horizontal-line';
                    bottomLine.style.bottom = '50mm';
                    page.appendChild(bottomLine);
                    
                    // æ·»åŠ ä¸Šæ–¹æ¨ªçº¿ä¸‹æ–¹çš„å°å­—ï¼ˆæ—‹è½¬180åº¦ï¼‰
                    const topText = document.createElement('div');
                    topText.className = 'mode5-text';
                    topText.textContent = 'ä»¥æˆå°±å®¢æˆ·ä¸ºå…ˆï¼Œä»¥è´¡çŒ®è€…ä¸ºæœ¬ï¼ŒåšæŒå¼€æ”¾åä½œï¼ŒæŒç»­è¿½æ±‚å“è¶Š';
                    topText.style.top = 'calc(50mm + 15px)'; // ä½äºä¸Šæ–¹æ¨ªçº¿ä¸‹æ–¹15pxå¤„
                    topText.style.transform = 'rotate(180deg)';
                    page.appendChild(topText);
                    
                    // æ·»åŠ ä¸‹æ–¹æ¨ªçº¿ä¸Šæ–¹çš„å°å­—ï¼ˆæ­£å¸¸æ–¹å‘ï¼‰
                    const bottomText = document.createElement('div');
                    bottomText.className = 'mode5-text';
                    bottomText.textContent = 'ä»¥æˆå°±å®¢æˆ·ä¸ºå…ˆï¼Œä»¥è´¡çŒ®è€…ä¸ºæœ¬ï¼ŒåšæŒå¼€æ”¾åä½œï¼ŒæŒç»­è¿½æ±‚å“è¶Š';
                    bottomText.style.bottom = 'calc(50mm + 15px)'; // ä½äºä¸‹æ–¹æ¨ªçº¿ä¸Šæ–¹15pxå¤„
                    page.appendChild(bottomText);
                    
                    // æ·»åŠ å·¦ä¸Šè§’logo
                    const topLeftLogo = document.createElement('img');
                    topLeftLogo.src = 'acd.png';
                    topLeftLogo.className = 'mode5-logo';
                    topLeftLogo.style.top = '155mm';
                    topLeftLogo.style.left = '12mm';
                    page.appendChild(topLeftLogo);
                    
                    // æ·»åŠ å³ä¸‹è§’logo - æ—‹è½¬180åº¦
                    const bottomRightLogo = document.createElement('img');
                    bottomRightLogo.src = 'acd.png';
                    bottomRightLogo.className = 'mode5-logo';
                    bottomRightLogo.style.bottom = '155mm';
                    bottomRightLogo.style.right = '12mm';
                    bottomRightLogo.style.transform = 'rotate(180deg)';
                    page.appendChild(bottomRightLogo);
                    
                    // åˆ›å»ºä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬180åº¦ï¼‰
                    const leftName = document.createElement('div');
                    leftName.className = 'mode5-name left';
                    leftName.textContent = nameText;
                    leftName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // åˆ›å»ºä¸‹æ–¹åå­—ï¼ˆæ­£å¸¸æ–¹å‘ï¼‰
                    const rightName = document.createElement('div');
                    rightName.className = 'mode5-name right';
                    rightName.textContent = nameText;
                    rightName.style.zIndex = '2'; // ç¡®ä¿æ–‡å­—åœ¨å›¾ç‰‡ä¸Šæ–¹
                    
                    // æ£€æµ‹æ˜¯å¦ä¸ºè‹±æ–‡åå­—ï¼ˆåŒ…å«è‹±æ–‡å­—æ¯æˆ–ç©ºæ ¼ï¼‰
                    const isEnglishName = /[a-zA-Z\s]/.test(nameText);
                    
                    // å¦‚æœæ˜¯è‹±æ–‡åå­—ä¸”è¾ƒé•¿ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
                    if (isEnglishName) {
                        // æ·»åŠ è‹±æ–‡åå­—æ ‡è¯†ç±»
                        leftName.classList.add('english-name');
                        rightName.classList.add('english-name');
                        
                        // æ ¹æ®åå­—é•¿åº¦åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        let fontSize = 110; // é»˜è®¤å­—ä½“å¤§å°
                        let lineHeight = 1.2; // é»˜è®¤è¡Œé«˜
                        
                        // è§£æåå­—ï¼Œå¤„ç†å¯èƒ½åŒ…å«è¿å­—ç¬¦çš„æƒ…å†µ
                        const nameWords = nameText.split(/[\s-]+/).filter(word => word.trim() !== '');
                        const totalLength = nameText.length;
                        const wordCount = nameWords.length;
                        
                        // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                        if (totalLength > 20 || wordCount >= 4) {
                            fontSize = 60; // éå¸¸é•¿çš„åå­—
                            lineHeight = 1.1;
                        } else if (totalLength > 15 || wordCount >= 3) {
                            fontSize = 75; // è¾ƒé•¿çš„åå­—
                            lineHeight = 1.15;
                        } else if (totalLength > 10 || wordCount >= 2) {
                            fontSize = 90; // ä¸­ç­‰é•¿åº¦çš„åå­—
                        }
                        
                        // åº”ç”¨å­—ä½“å¤§å°å’Œè¡Œé«˜
                        leftName.style.fontSize = `${fontSize}px`;
                        rightName.style.fontSize = `${fontSize}px`;
                        leftName.style.lineHeight = lineHeight.toString();
                        rightName.style.lineHeight = lineHeight.toString();
                        
                        // å¯ç”¨è‡ªåŠ¨æ¢è¡Œ
                        leftName.style.whiteSpace = 'pre-wrap';
                        rightName.style.whiteSpace = 'pre-wrap';
                        
                        // è°ƒæ•´ä½ç½®ï¼Œç¡®ä¿æ–‡æœ¬å±…ä¸­æ˜¾ç¤º
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                        
                        // æ ¹æ®åå­—é•¿åº¦å’Œç»“æ„å†³å®šå¦‚ä½•åˆ†è¡Œæ˜¾ç¤º
                        let formattedText = nameText;
                        
                        // ç‰¹æ®Šå¤„ç†ç±»ä¼¼äº"Schaerer-Lim Mei Qin Genevieve"è¿™æ ·çš„æ ¼å¼
                        if (nameText.includes('-') || wordCount >= 3) {
                            // æ£€æŸ¥æ˜¯å¦ä¸ºå¸¦è¿å­—ç¬¦çš„è‹±æ–‡åï¼Œå¦‚"Schaerer-Lim Mei Qin Genevieve"
                            if (nameText.includes('-')) {
                                // å°†è¿å­—ç¬¦éƒ¨åˆ†ä½œä¸ºç¬¬ä¸€è¡Œ
                                const hyphenParts = nameText.split(' ');
                                const firstPart = hyphenParts[0]; // è·å–"Schaerer-Lim"éƒ¨åˆ†
                                const secondPart = hyphenParts.slice(1).join(' '); // è·å–åé¢çš„åå­—éƒ¨åˆ†
                                formattedText = `${firstPart}\n${secondPart}`;
                            } else {
                                // é’ˆå¯¹"Schaerer-Lim Mei Qin Genevieve"è¿™æ ·çš„åå­—ç‰¹æ®Šå¤„ç†
                                const specialNames = [
                                    "Schaerer-Lim Mei Qin Genevieve",
                                    "Schaerer Lim Mei Qin Genevieve"
                                ];
                                
                                if (specialNames.includes(nameText)) {
                                    formattedText = "Schaerer-Lim\nMei Qin Genevieve";
                                } else {
                                    // å¸¸è§„é•¿åå­—å¤„ç†
                                    const midPoint = nameText.indexOf(' ', nameText.length / 3);
                                    
                                    if (midPoint > 0) {
                                        // å°†åå­—åˆ†ä¸ºä¸¤è¡Œï¼Œåœ¨æŸä¸ªä½ç½®åˆ†éš”
                                        const firstPart = nameText.substring(0, midPoint);
                                        const secondPart = nameText.substring(midPoint).trim();
                                        formattedText = `${firstPart}\n${secondPart}`;
                                    } else {
                                        // å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„åˆ†è¡Œç‚¹ï¼ŒæŒ‰ç…§å•è¯æ•°é‡åˆ†è¡Œ
                                        const midWordIndex = Math.ceil(wordCount / 2);
                                        const firstLine = nameWords.slice(0, midWordIndex).join(' ');
                                        const secondLine = nameWords.slice(midWordIndex).join(' ');
                                        formattedText = `${firstLine}\n${secondLine}`;
                                    }
                                }
                            }
                        }
                        
                        leftName.textContent = formattedText;
                        rightName.textContent = formattedText;
                    }
                    // å¦‚æœæ˜¯ä¸¤ä¸ªå­—çš„ä¸­æ–‡åå­—ï¼Œæ·»åŠ ç‰¹æ®Šå¤„ç†
                    else if (nameText.length === 2) {
                        leftName.classList.add('two-chars');
                        rightName.classList.add('two-chars');
                        
                        // å¯¹ä¸¤ä¸ªå­—çš„åå­—åº”ç”¨å®Œå…¨è‡ªå®šä¹‰çš„æ ·å¼
                        leftName.style.letterSpacing = '0.8em';
                        rightName.style.letterSpacing = '0.8em';
                        
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // ä¸Šæ–¹åå­—ï¼ˆæ—‹è½¬çš„ï¼‰éœ€è¦ç‹¬ç«‹è°ƒæ•´
                        leftName.style.transform = 'translate(calc(-50% - 0.4em), -50%) rotate(180deg)';
                        
                        // ä¸‹æ–¹åå­—ä¹Ÿéœ€è¦åŒæ ·çš„æ°´å¹³è°ƒæ•´ï¼Œä¿æŒç›¸åŒçš„åç§»è¡¥å¿
                        rightName.style.transform = 'translate(calc(-50% + 0.4em), 50%)';
                    } else {
                        // ä¸‰ä¸ªå­—åŠä»¥ä¸Šçš„ä¸­æ–‡åå­—å¤„ç†
                        // æ¸…é™¤é»˜è®¤CSSç±»çš„transform
                        leftName.style.transform = '';
                        rightName.style.transform = '';
                        
                        // åº”ç”¨æ–°çš„transform
                        leftName.style.transform = 'translate(-50%, -50%) rotate(180deg)';
                        rightName.style.transform = 'translate(-50%, 50%)';
                    }
                    
                    // æ·»åŠ å…ƒç´ åˆ°é¡µé¢
                    page.appendChild(leftName);
                    page.appendChild(rightName);
                    
                    // æ·»åŠ é¡µé¢åˆ°é¢„è§ˆåŒºåŸŸ
                    previewArea.appendChild(page);
                }
            } else if (layoutMode === 'mode6') {
                // æ¨¡å¼å…­ï¼šç½‘æ ¼å¸ƒå±€ï¼Œæ¯é¡µ8ä¸ªåç‰Œï¼ˆä¸­æ–‡+å›ºå®šæ–‡æœ¬ï¼‰
                for (let i = 0; i < names.length; i += 8) {
                    const page = document.createElement('div');
                    page.className = 'page';
                    page.style.position = 'relative';
                    page.style.width = '210mm';
                    page.style.height = '297mm';
                    
                    const grid = document.createElement('div');
                    grid.className = 'mode6-grid';
                    page.appendChild(grid);
                    
                    // æ·»åŠ æ°´å¹³å’Œå‚ç›´åˆ†å‰²çº¿
                    const horizontalLine = document.createElement('div');
                    horizontalLine.className = 'mode6-horizontal-line';
                    grid.appendChild(horizontalLine);
                    
                    const verticalLine = document.createElement('div');
                    verticalLine.className = 'mode6-vertical-line';
                    grid.appendChild(verticalLine);
                    
                    // è®¡ç®—å½“å‰é¡µé¢åº”è¯¥åŒ…å«çš„åå­—æ•°é‡
                    const namesInThisPage = Math.min(8, names.length - i);
                    
                    // åˆ›å»ºåç‰Œ
                    for (let j = 0; j < namesInThisPage; j++) {
                        const name = names[i + j].trim();
                        
                        // åˆ›å»ºæ¨¡å¼å…­çš„å¡ç‰‡
                        const card = createMode6Card(name);
                        
                        grid.appendChild(card);
                    }
                    
                    previewArea.appendChild(page);
                }
            }
        });
    </script>
    
    <script>
        // ç®€å•è€Œç›´æ¥çš„æ‹¼éŸ³è½¬æ¢å‡½æ•°
        function toPinyin(chinese) {
            if (!chinese || chinese.trim() === '') return '';
            
            try {
                // æ£€æŸ¥pinyinProå…¨å±€å¯¹è±¡
                if (typeof pinyinPro === 'object' && typeof pinyinPro.pinyin === 'function') {
                    // ä½¿ç”¨pinyin-proçš„pinyinå‡½æ•°è·å–æ‹¼éŸ³æ•°ç»„
                    let pinyinResult = pinyinPro.pinyin(chinese, {
                        toneType: 'none',     // ä¸å¸¦å£°è°ƒ
                        type: 'array',        // è¿”å›æ•°ç»„æ ¼å¼ï¼Œä¾¿äºå¤„ç†
                        separator: ' '        // ç©ºæ ¼åˆ†éš”
                    });
                    
                    // æ‰‹åŠ¨å°†æ¯ä¸ªæ‹¼éŸ³çš„é¦–å­—æ¯è½¬ä¸ºå¤§å†™
                    return pinyinResult.map(word => {
                        if (word && word.length > 0) {
                            return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
                        }
                        return word;
                    }).join(' ');
                } else {
                    console.error('pinyinProåº“æœªæ­£ç¡®åŠ è½½');
                    return chinese;
                }
            } catch (error) {
                console.error('æ‹¼éŸ³è½¬æ¢é”™è¯¯:', error);
                return chinese;
            }
        }

        function createMode2Card(name, pinyin) {
            const card = document.createElement('div');
            card.className = 'mode2-card';

            // æ·»åŠ logo
            const logo = document.createElement('img');
            logo.src = 'inovance-logo.png';
            logo.className = 'mode2-logo';
            card.appendChild(logo);

            // æ·»åŠ å§“å
            const nameElement = document.createElement('div');
            nameElement.className = 'mode2-name' + (name.length === 2 ? ' two-chars' : '');
            nameElement.textContent = name;
            card.appendChild(nameElement);

            // æ·»åŠ æ‹¼éŸ³
            const pinyinElement = document.createElement('div');
            pinyinElement.className = 'mode2-pinyin';
            pinyinElement.textContent = pinyin;
            card.appendChild(pinyinElement);

            return card;
        }

        // åˆ›å»ºæ¨¡å¼å…­å¡ç‰‡å‡½æ•°
        function createMode6Card(name) {
            const card = document.createElement('div');
            card.className = 'mode6-card';
            
            // æ·»åŠ logo
            const logo = document.createElement('img');
            logo.src = 'acd.png';
            logo.className = 'mode6-logo';
            card.appendChild(logo);
            
            // åˆ›å»ºåå­—å…ƒç´ 
            const nameElement = document.createElement('div');
            
            // æ£€æµ‹æ˜¯å¦ä¸ºè‹±æ–‡åå­—ï¼ˆåŒ…å«è‹±æ–‡å­—æ¯æˆ–ç©ºæ ¼ï¼‰
            const isEnglishName = /[a-zA-Z\s]/.test(name);
            
            if (isEnglishName) {
                nameElement.className = 'mode6-name';
                
                // è§£æåå­—ï¼Œå¤„ç†å¯èƒ½åŒ…å«è¿å­—ç¬¦çš„æƒ…å†µ
                const nameWords = name.split(/[\s-]+/).filter(word => word.trim() !== '');
                const totalLength = name.length;
                const wordCount = nameWords.length;
                
                // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
                let fontSize = 55; // æ›´å°çš„é»˜è®¤å­—ä½“å¤§å°
                if (totalLength > 20 || wordCount >= 4) {
                    fontSize = 32; // éå¸¸é•¿çš„åå­—
                } else if (totalLength > 15 || wordCount >= 3) {
                    fontSize = 40; // è¾ƒé•¿çš„åå­—
                } else if (totalLength > 10 || wordCount >= 2) {
                    fontSize = 45; // ä¸­ç­‰é•¿åº¦çš„åå­—
                }
                
                nameElement.style.fontSize = `${fontSize}px`;
                
                // å¤„ç†æ¢è¡Œ
                if (wordCount > 1) {
                    // è®¾ç½®è‡ªåŠ¨æ¢è¡Œ
                    nameElement.style.whiteSpace = 'pre-wrap';
                    nameElement.style.lineHeight = '1.1';
                    
                    // æ ¹æ®å•è¯æ•°é‡ç¡®å®šæ¢è¡Œä½ç½®
                    let formattedText = name;
                    if (wordCount === 2) {
                        // ä¸¤ä¸ªå•è¯ï¼Œæ”¾ä¸€è¡Œ
                        formattedText = name;
                    } else if (wordCount === 3) {
                        // ä¸‰ä¸ªå•è¯ï¼Œç¬¬ä¸€ä¸ªå•è¯ä¸€è¡Œï¼Œåä¸¤ä¸ªä¸€è¡Œ
                        const words = name.split(' ');
                        formattedText = `${words[0]}\n${words[1]} ${words[2]}`;
                    } else {
                        // å››ä¸ªæˆ–æ›´å¤šå•è¯ï¼Œå°è¯•å‡åŒ€åˆ†é…
                        const midPoint = Math.ceil(wordCount / 2);
                        const firstLine = nameWords.slice(0, midPoint).join(' ');
                        const secondLine = nameWords.slice(midPoint).join(' ');
                        formattedText = `${firstLine}\n${secondLine}`;
                    }
                    
                    nameElement.textContent = formattedText;
                } else {
                    nameElement.textContent = name;
                }
            } else {
                // æ£€æµ‹åå­—é•¿åº¦ï¼Œåº”ç”¨ä¸åŒæ ·å¼
                if (name.length === 2) {
                    nameElement.className = 'mode6-name two-chars';
                } else {
                    nameElement.className = 'mode6-name';
                }
                
                nameElement.textContent = name;
            }
            
            // æ— è®ºä¸­è‹±æ–‡åå­—ï¼Œéƒ½ä½¿ç”¨ç›¸åŒçš„ä¸Šè¾¹è·
            nameElement.style.marginTop = 'calc(0mm + 10px)';
            
            // åˆ›å»ºåº•éƒ¨æ–‡æœ¬å…ƒç´ ï¼Œä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬
            const textElement = document.createElement('div');
            textElement.className = 'mode6-pinyin';
            
            // è·å–ç”¨æˆ·è¾“å…¥çš„åº•éƒ¨æ–‡å­—
            const mode6SubtextInput = document.getElementById('mode6Subtext');
            textElement.textContent = mode6SubtextInput.value.trim();
            
            // å›ºå®šæ–‡æœ¬ä½ç½®ï¼Œæ— è®ºä¸­è‹±æ–‡åå­—ä½¿ç”¨ç›¸åŒçš„ä½ç½®
            // ä½¿ç”¨ç»å¯¹ä½ç½®è€Œéç›¸å¯¹ä½ç½®ï¼Œç¡®ä¿å›ºå®šåœ¨å¡ç‰‡åº•éƒ¨çš„å›ºå®šä½ç½®
            textElement.style.position = 'absolute';
            textElement.style.bottom = '10mm';
            textElement.style.left = '0';
            textElement.style.width = '100%';
            textElement.style.fontSize = '18px';
            
            card.appendChild(nameElement);
            card.appendChild(textElement);
            
            return card;
        }
    </script>
</body>
</html>